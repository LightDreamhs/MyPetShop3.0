# å® ç‰©åº—ç®¡ç†ç³»ç»Ÿ - æç®€éƒ¨ç½²æŒ‡å—

## ğŸ¯ é€‚ç”¨åœºæ™¯

- âœ… **å•äººä½¿ç”¨**æˆ–å°å›¢é˜Ÿ
- âœ… **è½»é‡è´Ÿè½½**ï¼ˆæ¯æ—¥è®¢å• < 100ï¼‰
- âœ… **ä¸éœ€è¦** HTTPS/SSLï¼ˆå¦‚éœ€è¦å¯ä»¥åæœŸåŠ ï¼‰
- âœ… **è¿½æ±‚ç®€å•**ï¼Œä¸æƒ³ç»´æŠ¤å¤šä¸ªæœåŠ¡

## ğŸ—ï¸ æ¶æ„å¯¹æ¯”

### âŒ å¤æ‚æ–¹æ¡ˆï¼ˆDockeråŸç”Ÿéƒ¨ç½²ï¼‰
```
å‰ç«¯å®¹å™¨(Nginx) + åç«¯å®¹å™¨(Spring) + MySQLå®¹å™¨
â†“
3ä¸ªå®¹å™¨ + Dockerç½‘ç»œ + å¤æ‚é…ç½®
```

### âœ… æç®€æ–¹æ¡ˆ
```
Spring Boot(80ç«¯å£) + MySQL(å®¹å™¨)
â†“
åªæœ‰2ä¸ªç»„ä»¶ï¼Œä¸€ä¸ªå¯åŠ¨è„šæœ¬
```

## âš¡ ä¸€é”®éƒ¨ç½²

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
git clone <your-repo> /opt/MyPetShop3.0
cd /opt/MyPetShop3.0/deployment

# 2. è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x simple-deploy.sh
sudo ./simple-deploy.sh
```

å°±è¿™ä¹ˆç®€å•ï¼è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
1. âœ… å®‰è£… Dockerã€Javaã€Maven
2. âœ… å¯åŠ¨ MySQL å®¹å™¨
3. âœ… æ„å»ºå‰åç«¯ï¼ˆå‰ç«¯æ‰“åŒ…è¿›åç«¯ï¼‰
4. âœ… é…ç½®ç³»ç»ŸæœåŠ¡
5. âœ… å¯åŠ¨åº”ç”¨ï¼ˆç›‘å¬80ç«¯å£ï¼‰

## ğŸ“‚ éƒ¨ç½²åçš„æ–‡ä»¶ç»“æ„

```
/opt/petshop/
â”œâ”€â”€ pet-shop-backend.jar     # åº”ç”¨JARåŒ…ï¼ˆåŒ…å«å‰åç«¯ï¼‰
â”œâ”€â”€ uploads/                  # ä¸Šä¼ çš„å›¾ç‰‡
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ app.log              # åº”ç”¨æ—¥å¿—
â”œâ”€â”€ start.sh                 # å¯åŠ¨è„šæœ¬
â””â”€â”€ stop.sh                  # åœæ­¢è„šæœ¬

/etc/systemd/system/
â””â”€â”€ petshop.service          # ç³»ç»ŸæœåŠ¡é…ç½®

```

## ğŸ”§ å…³é”®é…ç½®è¯´æ˜

### 1. ç«¯å£é…ç½®

åº”ç”¨ç›´æ¥ç›‘å¬ **80ç«¯å£**ï¼Œæ— éœ€ Nginx åå‘ä»£ç†ï¼š
- è®¿é—®å‰ç«¯ï¼š`http://your-server-ip/`
- è®¿é—®APIï¼š`http://your-server-ip/api/v1/...`
- è®¿é—®å›¾ç‰‡ï¼š`http://your-server-ip/uploads/images/...`

### 2. å‰ç«¯é™æ€æ–‡ä»¶

å‰ç«¯æ‰“åŒ…åçš„æ–‡ä»¶ä¼šè‡ªåŠ¨æ”¾å…¥ `backend/src/main/resources/static/`
- Spring Boot ä¼šç›´æ¥æä¾›é™æ€æ–‡ä»¶æœåŠ¡
- æ”¯æŒå‰ç«¯è·¯ç”±ï¼ˆæ‰€æœ‰è·¯å¾„éƒ½è¿”å› index.htmlï¼‰

### 3. å›¾ç‰‡ä¸Šä¼ 

- ä¸Šä¼ ç›®å½•ï¼š`/opt/petshop/uploads`
- è®¿é—®URLï¼š`http://your-domain/uploads/images/xxx.jpg`
- Spring Boot é™æ€èµ„æºæ˜ å°„è‡ªåŠ¨å¤„ç†

## ğŸ“Š æ€§èƒ½è¯´æ˜

### Spring Boot (Tomcat) æ€§èƒ½

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| æœ€å¤§å¹¶å‘ | 200+ | é»˜è®¤é…ç½® |
| æ¯ç§’è¯·æ±‚æ•° | 1000+ | è¿œè¶…ä½ çš„éœ€æ±‚ |
| å†…å­˜å ç”¨ | ~512MB | JVMé…ç½® |
| CPUå ç”¨ | <5% | ç©ºé—²æ—¶ |

**ä½ çš„ä½¿ç”¨åœºæ™¯**ï¼š
- æ¯æ—¥30å• â‰ˆ æ¯åˆ†é’Ÿ 0.02 å•
- å³ä½¿å³°å€¼100å€ = æ¯åˆ†é’Ÿ 2 å•
- **å®Œå…¨å¤Ÿç”¨ï¼**

## ğŸ› ï¸ å¸¸ç”¨æ“ä½œ

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f /opt/petshop/logs/app.log

# æŸ¥çœ‹ systemd æ—¥å¿—
journalctl -u petshop -f
```

### é‡å¯æœåŠ¡

```bash
# é‡å¯åº”ç”¨
sudo systemctl restart petshop

# é‡å¯ MySQL
docker restart petshop-mysql
```

### æ›´æ–°åº”ç”¨

```bash
cd /opt/MyPetShop3.0

# æ‹‰å–æœ€æ–°ä»£ç 
git pull

# é‡æ–°éƒ¨ç½²
cd deployment
sudo ./simple-deploy.sh
```

### æ•°æ®åº“å¤‡ä»½

```bash
# å¤‡ä»½
docker exec petshop-mysql mysqldump -u petshop -p pet_shop_3_0 > backup.sql

# æ¢å¤
docker exec -i petshop-mysql mysql -u petshop -p pet_shop_3_0 < backup.sql
```

## ğŸ” å®‰å…¨å»ºè®®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 

é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹ç®¡ç†å‘˜å¯†ç ï¼

### 2. é…ç½®é˜²ç«å¢™

```bash
sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw enable
```

### 3. ï¼ˆå¯é€‰ï¼‰é…ç½® HTTPS

å¦‚æœéœ€è¦ HTTPSï¼Œå¯ä»¥æ·»åŠ  Nginx åšåå‘ä»£ç†å’Œ SSL ç»ˆæ­¢ï¼š

```bash
# å®‰è£… Nginx å’Œ Certbot
sudo apt install nginx certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# Nginx ä¼šè‡ªåŠ¨é…ç½® SSL å¹¶åå‘ä»£ç†åˆ° 80ç«¯å£
```

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸éœ€è¦ Nginxï¼Ÿ

**A**: Spring Boot å†…ç½®çš„ Tomcat å®Œå…¨å¯ä»¥å¤„ç†é™æ€æ–‡ä»¶å’Œ API è¯·æ±‚ï¼Œå¯¹äºè½»é‡åº”ç”¨å®Œå…¨å¤Ÿç”¨ã€‚

### Q2: æ€§èƒ½ä¼šä¸ä¼šä¸å¥½ï¼Ÿ

**A**: ä¸ä¼šã€‚Tomcat å¯ä»¥è½»æ¾å¤„ç†æ•°åƒå¹¶å‘è¯·æ±‚ï¼Œä½ çš„æ¯æ—¥30å•åªæ˜¯æ²§æµ·ä¸€ç²Ÿã€‚

### Q3: åæœŸå¯ä»¥åŠ  Nginx å—ï¼Ÿ

**A**: å¯ä»¥ï¼åæœŸå¦‚æœæœ‰éœ€è¦ï¼Œåªéœ€åœ¨å‰é¢åŠ  Nginx åšåå‘ä»£ç†å³å¯ï¼Œåº”ç”¨æ— éœ€ä¿®æ”¹ã€‚

### Q4: å¦‚ä½•æŸ¥çœ‹ä¸Šä¼ çš„å›¾ç‰‡ï¼Ÿ

**A**:
- æ–‡ä»¶ä½ç½®ï¼š`/opt/petshop/uploads/images/`
- è®¿é—®URLï¼š`http://your-ip/uploads/images/æ–‡ä»¶å.jpg`

### Q5: åº”ç”¨å´©æºƒäº†æ€ä¹ˆåŠï¼Ÿ

**A**: systemd ä¼šè‡ªåŠ¨é‡å¯åº”ç”¨ã€‚æŸ¥çœ‹æ—¥å¿—æ’æŸ¥é—®é¢˜ï¼š
```bash
tail -f /opt/petshop/logs/app.log
```

## ğŸ“ æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ
1. æŸ¥çœ‹æ—¥å¿—ï¼š`/opt/petshop/logs/app.log`
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š`systemctl status petshop`
3. æŸ¥çœ‹ MySQL æ—¥å¿—ï¼š`docker logs petshop-mysql`

## ğŸ‰ æ€»ç»“

è¿™ä¸ªæç®€æ–¹æ¡ˆï¼š
- âœ… **åªéœ€è¦2ä¸ªç»„ä»¶**ï¼ˆSpring Boot + MySQLï¼‰
- âœ… **ä¸€é”®éƒ¨ç½²**ï¼Œ5åˆ†é’Ÿæå®š
- âœ… **å®Œå…¨å¤Ÿç”¨**çš„æ€§èƒ½
- âœ… **æ˜“äºç»´æŠ¤**ï¼Œå‡ºé”™æ¦‚ç‡ä½
- âœ… **åæœŸå¯æ‰©å±•**ï¼Œéœ€è¦æ—¶å†åŠ  Nginx

**ç‰¹åˆ«é€‚åˆä½ çš„ä½¿ç”¨åœºæ™¯ï¼**
